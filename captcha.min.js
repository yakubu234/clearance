/* base url fetcher */ 
function base_url(){
	var pathparts = location.pathname.split('/');
	if (location.host == 'localhost') {
	var url = location.origin+'/'+pathparts[1].trim('/')+'/'; // http://localhost/myproject/
	}else{
	var url = location.origin+'/'; // http://myurl.com
	}
	return url;
}
var base_url = base_url();

/*  */ 
function confirmCaptcha(){
	var html="";
	var uniqueid = document.getElementById('uniqueid');var clearAny = document.getElementById('CaptchaInput');
	html += GenerateCaptcha();
	document.getElementById('CaptchaDiv').innerHTML = html;
	uniqueid.value = html;
	clearAny.value="";
    delete console.log;
   	console.log; 
}
confirmCaptcha();


/*  */ 
function limitText(limitField, limitNum) {
	var dd = '';
	limitField.value.length > limitNum ? limitField.value = limitField.value.substring(0, limitNum):dd ;
	limitField.value.length == limitNum ? authCaptcha(limitField.value):dd ;
} 

/*  */ 
function authCaptcha(limitField){
	var uniqueid = document.getElementById('uniqueid').value;
	if ((uniqueid != null || uniqueid!= "")&& (limitField != null || limitField!= "")) {
		(uniqueid == limitField)?showCorrect():showWrong();
	}else{}
	delete console.log;
    console.log; 
}

/*  */ 
function showCorrect(){
	document.getElementById('uniqueid').value = 'true'+Math.floor(Math.random()*8+1)+Math.random().toString().slice(2,10);
	// alert('correct');
}

/*  */ 
function showWrong(){
	var str = document.getElementById('uniqueid').value;
	var res = str.substring(0, 4);
	if(res != 'true'){
	alert('Wrong! please retype the Captcha');
	confirmCaptcha();
	}
}

/* captcha generator */ 
function GenerateCaptcha(){
var ctx;
/*alphaNums contains the characters with which you want to create the CAPTCHA*/
let alphaNums = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
let emptyArr = [];
/*This loop generates a random string of 7 characters using alphaNums  Further this string is displayed as a CAPTCHA*/
for (let i = 1; i <= 6; i++) {
 emptyArr.push(alphaNums[Math.floor(Math.random() * alphaNums.length)]);
}
var c = emptyArr.join('');
return c;
}

/* slider query */ 
function doSlide (slider) {
	var id, o = slider.querySelectorAll("input.slide"), last = o.length-1, current = slider.querySelector("input.slide:checked");
	for (var i=0; i<o.length; i++) if (o[i] === current) {id = i; break;}
	o[id >= last ? 0 : id + 1].click();
}

function onSlide (e) {
	var o = e.target.parentNode;
	clearTimeout(o.autoslider);
	o.autoslider = setTimeout(function(){doSlide(o);}, 7e3);
}

$(function(){
	$(document).on("click", "input.slide", onSlide);
	$(".slider").each(function(){doSlide(this)});
});

